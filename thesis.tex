\input{shortcuts.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Document formatting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% To print in a4
%\documentclass[a4,10pt,twoside,openright,english,italian]{book}% twoside!
% To print in A5
\documentclass[10pt,twoside,openright,english,italian]{book}% twoside!

% Set paper size
\usepackage[twoside=true]{geometry}
% In the weird format
\geometry{
	paperwidth=17cm,
	paperheight=24cm,
	margin=2cm,
	top=2.3cm,
	bindingoffset=0.4cm
}
% A4
% \geometry{a4paper,
%   margin=3cm,
%   top=3.8cm,
%   bindingoffset=0.4cm
% }

%Uncomment this for final prints: this just enables printing on a4 paper
%\usepackage[cam,center,a4,pdflatex,axes]{crop}

\usepackage{phdthesis}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Custom Packages
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{pgf}
\usepackage{pgfplots}
%\pgfplotsset{compat=1.11}
\usepackage{tikz}
\pgfplotsset{compat=1.9} % set advanced options of tikz
\usetikzlibrary{positioning}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{automata}
\usetikzlibrary{arrows}
\usepackage{neuralnetwork}

\usepackage{fancyhdr}
\usepackage{color}
\usepackage{array}
\usepackage{mdwmath}
\usepackage{mdwtab}
\usepackage{amsmath,amsthm,amssymb}
%\usepackage{cite}
\usepackage{graphicx}
%\usepackage{glossaries}
\usepackage{listings}
%\usepackage{subfig}% hyperref support within the subfig package is broken
\usepackage{booktabs}
\usepackage{latexsym}
\usepackage{color}
\usepackage{url}
\usepackage{bnf}
\usepackage{rotating}
\usepackage{multirow}
\usepackage{phdtitle}
\usepackage{paralist}
%\usepackage{bibentry}
%\usepackage[algochapter]{algorithm2e}
\usepackage{lscape}
%\usepackage{algorithmic}
\usepackage{algorithm}
\usepackage{longtable}
\usepackage[T1]{fontenc}
\usepackage[latin1]{inputenc}
%\usepackage[utf8]{inputenc}
\usepackage{authblk}
\usepackage[framemethod=tikz]{mdframed}
\usepackage{natbib}
\usepackage{subcaption}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{epigraph}
\usepackage{float}
\usepackage{todonotes}
\setlength{\marginparwidth}{3cm}  % Set margin width for todonotes

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Language and notation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage[english,italian]{babel} % has to precede hyperref to set the language of \autoref
\usepackage[bookmarks=true,pdftex=false,bookmarksopen=true,pdfborder={0,0,0}]{hyperref}
% Change section, subsection and subsubsection to Section (in autoref)
\addto\extrasenglish{%
    \renewcommand{\sectionautorefname}{Section \negthinspace}
}
\addto\extrasenglish{%
    \renewcommand{\subsectionautorefname}{Section \negthinspace}
}
\addto\extrasenglish{%
    \renewcommand{\subsubsectionautorefname}{Section \negthinspace}
}
% Change chapter to Chapter (in autoref)
\addto\extrasenglish{%
    \renewcommand{\chapterautorefname}{Chapter \negthinspace}
}
\hyphenation{}

\newtheorem{Definition}{Definition}[section]


\lstset{tabsize=2,basicstyle=\footnotesize,breaklines=true}
\usepackage{ulem}
\normalem

\begin{hyphenrules}{english}
    \hyphenation{La-yer Va-nil-la DEConv-LSTM Deconv-LSTM Trans-conv-LSTM}
\end{hyphenrules}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Neural network customization
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%% neural network (to draw figures)
% Text on links
\tikzset{mystyle/.style={red, draw=blue, fill=yellow!20}}
\newcommand{\wilink}[4] {
    % from layer=#1, from node=#2, to layer=#3, to node=#4
    $w_{#2}$
}
\newcommand{\wijlink}[4] {
    % from layer=#1, from node=#2, to layer=#3, to node=#4
    $\scriptscriptstyle w_{#2#4}$
}
\newcommand{\wijllink}[4] {
    % from layer=#1, from node=#2, to layer=#3, to node=#4
    $\scriptscriptstyle w_{#4#2}^{(#3)}$
}
% Text on nodes
\newcommand{\nodetextclear}[2]{}
\newcommand{\nodetextxi}[2]{
    \ifnum0=#2\relax
        $b$
    \else
        $x_#2$
    \fi
}
\newcommand{\nodetexthi}[2]{
    \ifnum0=#2\relax
        $b$
    \else
        $h_#2^{(#1)}$
        %$h_#2$
    \fi
}
\newcommand{\nodetextyi}[2]{$y_#2$}
\newcommand{\nodetexts}[2]{$s$}
\newcommand{\nodetextsigma}[2]{$\Sigma$}
\newcommand{\nodetexty}[2]{$y$}
% Step function
\newcommand{\nodetextstep}[2]{
    \tikzstyle{input} = [coordinate]
    \begin{tikzpicture}[auto, >=latex']
        \draw[line width=0.05mm](0,0)  +(0,-6pt) -- +(0,6pt); % thin vert
        \draw[line width=0.25mm](0,0)  +(0pt,3pt) -- +(6pt,3pt); % wide top horiz
        \draw[line width=0.25mm](0,0)  +(0,-3pt) -- +(0,3pt); % wide vert
        \draw[line width=0.25mm](0,0)  +(-6pt,-3pt) -- +(0pt,-3pt); % wide top horiz
    \end{tikzpicture}
}
% Sigmoid function
\newcommand{\nodetextsigmoid}[2]{
    \begin{tikzpicture}[auto, >=latex']
        \begin{axis}[hide axis, scale only axis, height=2ex]
            \addplot[color=black]{1/(1+exp(-x))-2};
        \end{axis}
    \end{tikzpicture}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Title, names, etc, ..
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\hypersetup{pdftitle={Deep Recurrent Neural Networks for visual scene understanding}, pdfauthor={Visin Francesco}}

%\nobibliography*

\department {Department of Electronics, Information and Bioengineering}
\phdprogram{Doctoral Programme In Computer Science}

\author{Francesco Visin}
\title{Deep Recurrent Neural Networks for Visual Scene Understanding}
\supervisor{Matteo Matteucci}
\cosupervisor{Aaron Courville}
\tutor{Andrea Bonarini}
\chair{Andrea Bonarini}
\titleimage{img/logopoli.png}
\phdcycle{2016 -- XXVIII}

% From conv_arithmetic
\definecolor{blue}{RGB}{38,139,210}
\definecolor{cyan}{RGB}{42,161,152}
\definecolor{violet}{RGB}{108,113,196}
\definecolor{red}{RGB}{220,50,47}
\definecolor{base01}{RGB}{88,110,117}
\definecolor{base02}{RGB}{7,54,66}
\definecolor{base03}{RGB}{0,43,54}

\usetikzlibrary{calc,shapes,positioning}

\newtheorem{relationship}{Relationship}
\providecommand*{\relationshipautorefname}{Relationship}
\surroundwithmdframed[
    topline=false,
    bottomline=false,
    middlelinewidth=0.5pt,
    linecolor=base01,
    roundcorner=5pt,
    innertopmargin=0pt,
    leftmargin=15pt,
    rightmargin=15pt,
    nobreak=true,
]{relationship}

\let\originalepigraph\epigraph
\renewcommand\epigraph[2]{\originalepigraph{\textit{#1}}{\textsc{#2}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Others
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Force float to be top aligned
\makeatletter
    \setlength{\@fptop}{0pt}
    \setlength{\@fpbot}{0pt plus 1fill}
\makeatother

\makeatletter

% define a macro \Autoref to allow multiple references to be passed to \autoref
\newcommand\Autoref[1]{\@first@ref#1,@}
\def\@throw@dot#1.#2@{#1}% discard everything after the dot
\def\@set@refname#1{%    % set \@refname to autoefname+s using \getrefbykeydefault
    \edef\@tmp{\getrefbykeydefault{#1}{anchor}{}}%
    \def\@refname{\@nameuse{\expandafter\@throw@dot\@tmp.@autorefname}s}%
}
\def\@first@ref#1,#2{%
  \ifx#2@\autoref{#1}\let\@nextref\@gobble% only one ref, revert to normal \autoref
  \else%
    \@set@refname{#1}%  set \@refname to autoref name
    \@refname~\ref{#1}% add autoefname and first reference
    \let\@nextref\@next@ref% push processing to \@next@ref
  \fi%
  \@nextref#2%
}
\def\@next@ref#1,#2{%
   \ifx#2@ and~\ref{#1}\let\@nextref\@gobble% at end: print and+\ref and stop
   \else, \ref{#1}% print  ,+\ref and continue
   \fi%
   \@nextref#2%
}

\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Let's Start The Real Document
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\selectlanguage{english}

\hypersetup{pageanchor=false}
\maketitle

\pagestyle{empty}

\cleardoublepage
\newpage

\setlength{\epigraphwidth}{0.4\textwidth}
\epigraph{All models are wrong, but some are useful.}{George E. P. Box}
\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Acknowledgements
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\input{acknowledgements}

\cleardoublepage
\newpage
\hypersetup{pageanchor=true}

\pagestyle{fancy}
% change numbering into Roman numbers for the introductory part
\setcounter{page}{1}
\pagenumbering{Roman}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Abstract
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{chapters/abstract}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Summary
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \selectlanguage{english}
% \input{chapters/summary}
% \selectlanguage{english}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TOC
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\tableofcontents
\cleardoublepage
\newpage

% Now lets go back to normal numbering
\setcounter{page}{1}
\pagenumbering{arabic}

\cleardoublepage
\input{chapters/chapter1}
\input{chapters/chapter2}
\input{chapters/chapter3}
\input{chapters/chapter4}
\input{chapters/chapter5}
\input{chapters/chapter6}

%\cleardoublepage
%\listoffigures
%\listoftables

\cleardoublepage
\phantomsection
\addcontentsline{toc}{chapter}{\bibname}
\small
\bibliographystyle{natbib}
%\bibliographystyle{plain}
\bibliography{ml,myrefs,CV}

\end{document}
